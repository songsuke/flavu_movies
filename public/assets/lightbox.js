(function(){var t,e,n;t=jQuery,n=function(){function t(){this.fileLoadingImage="images/loading.gif",this.fileCloseImage="images/close.png",this.resizeDuration=700,this.fadeDuration=500,this.labelImage="Image",this.labelOf="of"}return t}(),e=function(){function e(t){this.options=t,this.album=[],this.currentImageIndex=void 0,this.init()}return e.prototype.init=function(){return this.enable(),this.build()},e.prototype.enable=function(){var e=this;return t("body").on("click","a[rel^=lightbox], area[rel^=lightbox]",function(n){return e.start(t(n.currentTarget)),!1})},e.prototype.build=function(){var e,n=this;t("<div>",{id:"lightboxOverlay"}).after(t("<div/>",{id:"lightbox"}).append(t("<div/>",{"class":"lb-outerContainer"}).append(t("<div/>",{"class":"lb-container"}).append(t("<img/>",{"class":"lb-image"}),t("<div/>",{"class":"lb-nav"}).append(t("<a/>",{"class":"lb-prev"}),t("<a/>",{"class":"lb-next"})),t("<div/>",{"class":"lb-loader"}).append(t("<a/>",{"class":"lb-cancel"}).append(t("<img/>",{src:this.options.fileLoadingImage}))))),t("<div/>",{"class":"lb-dataContainer"}).append(t("<div/>",{"class":"lb-data"}).append(t("<div/>",{"class":"lb-details"}).append(t("<span/>",{"class":"lb-caption"}),t("<span/>",{"class":"lb-number"})),t("<div/>",{"class":"lb-closeContainer"}).append(t("<a/>",{"class":"lb-close"}).append(t("<img/>",{src:this.options.fileCloseImage}))))))).appendTo(t("body")),t("#lightboxOverlay").hide().on("click",function(){return n.end(),!1}),e=t("#lightbox"),e.hide().on("click",function(e){return"lightbox"===t(e.target).attr("id")&&n.end(),!1}),e.find(".lb-outerContainer").on("click",function(e){return"lightbox"===t(e.target).attr("id")&&n.end(),!1}),e.find(".lb-prev").on("click",function(){return n.changeImage(n.currentImageIndex-1),!1}),e.find(".lb-next").on("click",function(){return n.changeImage(n.currentImageIndex+1),!1}),e.find(".lb-loader, .lb-close").on("click",function(){return n.end(),!1})},e.prototype.start=function(e){var n,i,r,o,s,a,l,u,c;if(t(window).on("resize",this.sizeOverlay),t("select, object, embed").css({visibility:"hidden"}),t("#lightboxOverlay").width(t(document).width()).height(t(document).height()).fadeIn(this.options.fadeDuration),this.album=[],s=0,"lightbox"===e.attr("rel"))this.album.push({link:e.attr("href"),title:e.attr("title")});else for(c=t(e.prop("tagName")+'[rel="'+e.attr("rel")+'"]'),o=0,u=c.length;u>o;o++)r=c[o],this.album.push({link:t(r).attr("href"),title:t(r).attr("title")}),t(r).attr("href")===e.attr("href")&&(s=o);i=t(window),l=i.scrollTop()+i.height()/10,a=i.scrollLeft(),n=t("#lightbox"),n.css({top:l+"px",left:a+"px"}).fadeIn(this.options.fadeDuration),this.changeImage(s)},e.prototype.changeImage=function(e){var n,i,r,o=this;this.disableKeyboardNav(),i=t("#lightbox"),n=i.find(".lb-image"),this.sizeOverlay(),t("#lightboxOverlay").fadeIn(this.options.fadeDuration),t(".loader").fadeIn("slow"),i.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),i.find(".lb-outerContainer").addClass("animating"),r=new Image,r.onload=function(){return n.attr("src",o.album[e].link),n.width=r.width,n.height=r.height,o.sizeContainer(r.width,r.height)},r.src=this.album[e].link,this.currentImageIndex=e},e.prototype.sizeOverlay=function(){return t("#lightboxOverlay").width(t(document).width()).height(t(document).height())},e.prototype.sizeContainer=function(e,n){var i,r,o,s,a,l,u,c,d,h,f,p=this;r=t("#lightbox"),o=r.find(".lb-outerContainer"),f=o.outerWidth(),h=o.outerHeight(),i=r.find(".lb-container"),u=parseInt(i.css("padding-top"),10),l=parseInt(i.css("padding-right"),10),s=parseInt(i.css("padding-bottom"),10),a=parseInt(i.css("padding-left"),10),d=e+a+l,c=n+u+s,d!==f&&c!==h?o.animate({width:d,height:c},this.options.resizeDuration,"swing"):d!==f?o.animate({width:d},this.options.resizeDuration,"swing"):c!==h&&o.animate({height:c},this.options.resizeDuration,"swing"),setTimeout(function(){r.find(".lb-dataContainer").width(d),r.find(".lb-prevLink").height(c),r.find(".lb-nextLink").height(c),p.showImage()},this.options.resizeDuration)},e.prototype.showImage=function(){var e;e=t("#lightbox"),e.find(".lb-loader").hide(),e.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},e.prototype.updateNav=function(){var e;e=t("#lightbox"),e.find(".lb-nav").show(),this.currentImageIndex>0&&e.find(".lb-prev").show(),this.currentImageIndex<this.album.length-1&&e.find(".lb-next").show()},e.prototype.updateDetails=function(){var e,n=this;e=t("#lightbox"),"undefined"!=typeof this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&e.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast"),this.album.length>1?e.find(".lb-number").html(this.options.labelImage+" "+(this.currentImageIndex+1)+" "+this.options.labelOf+"  "+this.album.length).fadeIn("fast"):e.find(".lb-number").hide(),e.find(".lb-outerContainer").removeClass("animating"),e.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return n.sizeOverlay()})},e.prototype.preloadNeighboringImages=function(){var t,e;this.album.length>this.currentImageIndex+1&&(t=new Image,t.src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&(e=new Image,e.src=this.album[this.currentImageIndex-1].link)},e.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},e.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},e.prototype.keyboardAction=function(t){var e,n,i,r,o;e=27,n=37,i=39,o=t.keyCode,r=String.fromCharCode(o).toLowerCase(),o===e||r.match(/x|o|c/)?this.end():"p"===r||o===n?0!==this.currentImageIndex&&this.changeImage(this.currentImageIndex-1):("n"===r||o===i)&&this.currentImageIndex!==this.album.length-1&&this.changeImage(this.currentImageIndex+1)},e.prototype.end=function(){return this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),t("#lightbox").fadeOut(this.options.fadeDuration),t("#lightboxOverlay").fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"})},e}(),t(function(){var t,i;return i=new n,t=new e(i)})}).call(this);